<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Propagation · Hemera</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="If you call a service which internally call many other services and suddenly a service fails, this error must be propagated to the first callee. In order to avoid storing very long error chains we do not collect all errors in the chain but the root issue."/><meta name="docsearch:version" content="5.0.0-rc.5"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Propagation · Hemera"/><meta property="og:type" content="website"/><meta property="og:url" content="https://hemerajs.github.io/hemera//hemera/index.html"/><meta property="og:description" content="If you call a service which internally call many other services and suddenly a service fails, this error must be propagated to the first callee. In order to avoid storing very long error chains we do not collect all errors in the chain but the root issue."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/hemera/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://hemerajs.github.io/hemera//hemera/blog/atom.xml" title="Hemera Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://hemerajs.github.io/hemera//hemera/blog/feed.xml" title="Hemera Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-115960465-1', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/hemera/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/hemera/"><img class="logo" src="/hemera/img/hemera-tiny.png" alt="Hemera"/><h2 class="headerTitleWithLogo">Hemera</h2></a><a href="/hemera/versions.html"><h3>5.0.0-rc.5</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/hemera/docs/5.0.0-rc.5/what-is-hemera.html" target="_self">Docs</a></li><li class=""><a href="/hemera/help.html" target="_self">Help</a></li><li class=""><a href="/hemera/blog/" target="_self">Blog</a></li><li class=""><a href="https://github.com/hemerajs/hemera" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Error handling</span></h2></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/what-is-hemera.html">What is Hemera?</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/installation.html">Installation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Basics</h3><ul><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/request-reply.html">Request &amp; Reply</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/pattern-matching.html">Pattern matching</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/publish-susbcribe.html">Publish &amp; Subscribe</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/payload-validation.html">Payload validation</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/middleware.html">Middleware</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/extension.html">Extension</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/logging.html">Logging</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/decorator.html">Decorators</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/metadata.html">Metadata</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/context.html">Context</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/delegate.html">Delegate</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/event.html">Events</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/codec.html">Codec</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/config.html">Config</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Plugins</h3><ul><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/ecosystem.html">Ecosystem</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/plugin.html">Create a plugin</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Error handling</h3><ul><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/error-handling.html">Introduction</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/error-serialization.html">Serialization</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/timeout.html">Timeouts</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/fatal.html">Fatal</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/propagation.html">Propagation</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/error-event.html">Events</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/protection.html">Protection</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Testing</h3><ul><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/integration.html">Integration</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/unit.html">Unit</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Tooling</h3><ul><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/monitoring.html">Monitoring</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/cli.html">Cli</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Advanced</h3><ul><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/docker.html">Docker</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/graphql.html">GraphQL</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/bridge.html">Bridge</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/clustering.html">Clustering</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/api-versioning.html">Api versioning</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/nats-limit.html">NATS characteristics</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/framework-integrations.html">Framework integrations</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/hemera-vs-seneca.html">Hemera Vs Seneca</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Api</h3><ul><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.5/reference.html">Reference</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docMainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Propagation</h1></header><article><div><span><p>If you call a service which internally call many other services and suddenly a service fails, this error must be propagated to the first callee. In order to avoid storing very long error chains we do not collect all errors in the chain but the root issue.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> nats = <span class="hljs-built_in">require</span>(<span class="hljs-string">'nats'</span>).connect(authUrl)
<span class="hljs-keyword">const</span> hemera = <span class="hljs-keyword">new</span> Hemera(nats)
<span class="hljs-keyword">const</span> UnauthorizedError = Hemera.createError(<span class="hljs-string">'Unauthorized'</span>)

hemera.ready(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  hemera.add(
    {
      <span class="hljs-attr">topic</span>: <span class="hljs-string">'a'</span>,
      <span class="hljs-attr">cmd</span>: <span class="hljs-string">'a'</span>
    },
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resp, cb</span>) </span>{
      <span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> UnauthorizedError(<span class="hljs-string">'test'</span>)
      a.test = <span class="hljs-number">444</span>
      cb(a)
    }
  )

  hemera.act(
    {
      <span class="hljs-attr">topic</span>: <span class="hljs-string">'a'</span>,
      <span class="hljs-attr">cmd</span>: <span class="hljs-string">'a'</span>
    },
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, resp</span>) </span>{
      <span class="hljs-comment">// err instanceof UnauthorizedError</span>
    }
  )
})
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="hops-error-property"></a><a href="#hops-error-property" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hops error property</h2>
<p>In addition to default error properties the <code>hops</code> property is added to understand which services were involved in the operation.</p>
<pre><code class="hljs css language-json">{
  name: "Unauthorized",
  message: "test",
  stack: "....",
  test: 444,
  hops: [
    {
      service: "a",
      method: "cmd:a,topic:a",
      app: "hemera-starptech",
      ts: 522330692412
    }
  ]
}
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/hemera/docs/5.0.0-rc.5/fatal.html"><span class="arrow-prev">← </span><span>Previous</span></a><a class="docs-next button" href="/hemera/docs/5.0.0-rc.5/error-event.html"><span>Next</span><span class="arrow-next"> →</span></a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/hemera/" class="nav-home"><img src="/hemera/img/hemera-blackwhite.png" alt="Hemera" width="66" height="58"/></a><div><h5>Docs</h5><a href="/hemera/docs/installation.html">Getting Started</a><a href="/hemera/docs/plugin.html">Create a plugin</a><a href="/hemera/docs/api.html">API Reference</a></div><div><h5>Community</h5><a href="/hemera/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/hemera" target="_blank">Stack Overflow</a><a href="https://gitter.im/hemerajs/hemera">Gitter Chat</a><a href="https://twitter.com/hemerajs" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/hemera/blog">Blog</a><a href="https://github.com/hemerajs/hemera">GitHub</a><a class="github-button" href="https://github.com/hemerajs/hemera/" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2018 Hemera.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: '5620e631e688fee9d15ed89f7d258f1a',
                indexName: 'hemerajs',
                inputSelector: '#search_input_react'
              });
            </script><script src="http://localhost:35729/livereload.js"></script></body></html>