<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Request and Reply · Hemera</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;NATS supports two flavors of request reply messaging: point-to-point or one-to-many. Point-to-point involves the fastest or first to respond. In a one-to-many exchange, you set a limit on the number of responses the requestor may receive. In a request-response exchange, publish request operation publishes a message with a reply subject expecting a response on that reply subject. You can request to automatically wait for a response inline. The request creates an INBOX-channel and performs a request call with the inbox reply and returns the first reply received. This is optimized in the case of multiple responses.&lt;/p&gt;
"/><meta name="docsearch:version" content="5.0.0-rc.2"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Request and Reply · Hemera"/><meta property="og:type" content="website"/><meta property="og:url" content="https://hemerajs.github.io/hemera//hemera/index.html"/><meta property="og:description" content="&lt;p&gt;NATS supports two flavors of request reply messaging: point-to-point or one-to-many. Point-to-point involves the fastest or first to respond. In a one-to-many exchange, you set a limit on the number of responses the requestor may receive. In a request-response exchange, publish request operation publishes a message with a reply subject expecting a response on that reply subject. You can request to automatically wait for a response inline. The request creates an INBOX-channel and performs a request call with the inbox reply and returns the first reply received. This is optimized in the case of multiple responses.&lt;/p&gt;
"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/hemera/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css"/><link rel="alternate" type="application/atom+xml" href="https://hemerajs.github.io/hemera//hemera/blog/atom.xml" title="Hemera Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://hemerajs.github.io/hemera//hemera/blog/feed.xml" title="Hemera Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-115960465-1', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/hemera/css/main.css"/><script src="/hemera/js/codetabs.js"></script></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/hemera/"><img class="logo" src="/hemera/img/hemera-tiny.png" alt="Hemera"/><h2 class="headerTitleWithLogo">Hemera</h2></a><a href="/hemera/versions.html"><h3>5.0.0-rc.2</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/hemera/docs/5.0.0-rc.2/what-is-hemera.html" target="_self">Docs</a></li><li class=""><a href="/hemera/help.html" target="_self">Help</a></li><li class=""><a href="/hemera/blog/" target="_self">Blog</a></li><li class=""><a href="https://github.com/hemerajs/hemera" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Basics</span></h2></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/what-is-hemera.html">What is Hemera?</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/installation.html">Installation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Basics</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/request-reply.html">Request &amp; Reply</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/pattern-matching.html">Pattern matching</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/publish-susbcribe.html">Publish &amp; Subscribe</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/payload-validation.html">Payload validation</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/middleware.html">Middleware</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/extension.html">Extension</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/logging.html">Logging</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/decorator.html">Decorators</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/metadata.html">Metadata</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/context.html">Context</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/delegate.html">Delegate</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/event.html">Events</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/codec.html">Codec</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Plugins</h3><ul class=""><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/ecosystem.html">Ecosystem</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/plugin.html">Create a plugin</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Error handling</h3><ul class=""><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/error-handling.html">Introduction</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/timeout.html">Timeouts</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/fatal.html">Fatal</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/propagation.html">Propagation</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/error-event.html">Events</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/protection.html">Protection</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Testing</h3><ul class=""><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/integration.html">Integration</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/unit.html">Unit</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Tooling</h3><ul class=""><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/monitoring.html">Monitoring</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/cli.html">Cli</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Advanced</h3><ul class=""><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/docker.html">Docker</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/graphql.html">GraphQL</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/bridge.html">Bridge</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/clustering.html">Clustering</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/api-versioning.html">Api versioning</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/nats-limit.html">NATS characteristics</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/framework-integrations.html">Framework integrations</a></li><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/hemera-vs-seneca.html">Hemera Vs Seneca</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Api</h3><ul class=""><li class="navListItem"><a class="navItem" href="/hemera/docs/5.0.0-rc.2/reference.html">Reference</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Request and Reply</h1></header><article><div><span><p>NATS supports two flavors of request reply messaging: point-to-point or one-to-many. Point-to-point involves the fastest or first to respond. In a one-to-many exchange, you set a limit on the number of responses the requestor may receive. In a request-response exchange, publish request operation publishes a message with a reply subject expecting a response on that reply subject. You can request to automatically wait for a response inline. The request creates an INBOX-channel and performs a request call with the inbox reply and returns the first reply received. This is optimized in the case of multiple responses.</p>
<h2><a class="anchor" aria-hidden="true" id="request-point-to-point"></a><a href="#request-point-to-point" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Request (point-to-point)</h2>
<p>Hemera using queue groups by default. All subscribers with the same queue name form the queue group. In Hemera a group name is the name of the topic. As messages on the registered subject are published, one member of the group is chosen randomly to receive the message. Although queue groups have multiple subscribers, each message is only consumed by only one. This allows us to load-balancing the traffic by NATS.</p>
<h2><a class="anchor" aria-hidden="true" id="nats-queueing"></a><a href="#nats-queueing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>NATS Queueing</h2>
<p>This is the default method to start a request. The INBOX-channel is automatically closed after the response.</p>
<pre><code class="hljs css language-js">hemera.act(
  {
    <span class="hljs-attr">topic</span>: <span class="hljs-string">'math'</span>,
    <span class="hljs-attr">cmd</span>: <span class="hljs-string">'add'</span>,
    <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">b</span>: <span class="hljs-number">1</span>
  },
  <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, resp</span>) </span>{}
)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="receive-multiple-messages"></a><a href="#receive-multiple-messages" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Receive multiple messages</h2>
<p>This allows you to receive multiple messages (in this case 10). If you don't receive 10 messages the INBOX channel is still open and you have to close it manually.</p>
<pre><code class="hljs css language-js">hemera.add(
  {
    <span class="hljs-attr">topic</span>: <span class="hljs-string">'math'</span>,
    <span class="hljs-attr">cmd</span>: <span class="hljs-string">'add'</span>
  },
  <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req</span>) </span>{
    <span class="hljs-keyword">this</span>.reply(req.a + req.b)
  }
)

hemera.act(
  {
    <span class="hljs-attr">topic</span>: <span class="hljs-string">'math'</span>,
    <span class="hljs-attr">cmd</span>: <span class="hljs-string">'add'</span>,
    <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">b</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">maxMessages$</span>: <span class="hljs-number">10</span>
  },
  <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, resp</span>) </span>{
    <span class="hljs-comment">// You can receive 10 messages but also need 10 responses</span>

    <span class="hljs-comment">// if you receive only 5 you have to close it</span>
    <span class="hljs-keyword">this</span>.remove(<span class="hljs-keyword">this</span>.sid)
  }
)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="receive-at-least-n-messages"></a><a href="#receive-at-least-n-messages" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Receive at least N messages</h2>
<p>This ensures that you have to receive at least N responses (in this case 5) within the timeout (default 2000) before a timeout error is thrown and the INBOX-channel is unsubscribed. You can't receive more than expected messages the INBOX-channel is closed automatically.</p>
<pre><code class="hljs css language-js">hemera.add(
  {
    <span class="hljs-attr">topic</span>: <span class="hljs-string">'math'</span>,
    <span class="hljs-attr">cmd</span>: <span class="hljs-string">'add'</span>
  },
  <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req</span>) </span>{
    <span class="hljs-keyword">this</span>.reply(req.a + req.b)
  }
)

hemera.act(
  {
    <span class="hljs-attr">topic</span>: <span class="hljs-string">'math'</span>,
    <span class="hljs-attr">cmd</span>: <span class="hljs-string">'add'</span>,
    <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">b</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">expectedMessages$</span>: <span class="hljs-number">5</span>
  },
  <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, resp</span>) </span>{
    <span class="hljs-comment">// You have to receive 5 responses</span>
  }
)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="receive-unknown-count-of-messages"></a><a href="#receive-unknown-count-of-messages" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Receive unknown count of messages</h2>
<p>This allows you to receive an unknown count of messages but be aware that you are responsible to close the INBOX-channel.</p>
<pre><code class="hljs css language-js">hemera.add(
  {
    <span class="hljs-attr">topic</span>: <span class="hljs-string">'math'</span>,
    <span class="hljs-attr">cmd</span>: <span class="hljs-string">'add'</span>
  },
  <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req</span>) </span>{
    <span class="hljs-keyword">this</span>.reply(req.a + req.b)
  }
)

hemera.act(
  {
    <span class="hljs-attr">topic</span>: <span class="hljs-string">'math'</span>,
    <span class="hljs-attr">cmd</span>: <span class="hljs-string">'add'</span>,
    <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">b</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">maxMessages$</span>: <span class="hljs-number">-1</span>
  },
  <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, resp</span>) </span>{
    <span class="hljs-comment">// close it anytime</span>
    <span class="hljs-keyword">this</span>.remove(<span class="hljs-keyword">this</span>.sid)
  }
)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="reply-anything"></a><a href="#reply-anything" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reply anything</h2>
<p>You can reply any value even primitive values like <code>true</code>, <code>1</code>, <code>5.0</code>. The first argument expect an error object.</p>
<pre><code class="hljs css language-js">hemera.add({
  <span class="hljs-attr">topic</span>: <span class="hljs-string">"math"</span>,
  <span class="hljs-attr">cmd</span>: <span class="hljs-string">"add"</span>,
}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, cb</span>) </span>{
  cb(<span class="hljs-literal">null</span>, req.a + req.b)
})
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="auto-unsubscribe"></a><a href="#auto-unsubscribe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Auto-unsubscribe</h2>
<p>The INBOX-channel of your request-reply action is automatically closed when the expected number of messages is reached, the maximum messages are proceed or the timeout is reached.</p>
<pre><code class="hljs css language-js">hemera.add(
  {
    <span class="hljs-attr">topic</span>: <span class="hljs-string">'math'</span>,
    <span class="hljs-attr">cmd</span>: <span class="hljs-string">'add'</span>,
    <span class="hljs-attr">maxMessages$</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">expectedMessages$</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">timeout$</span>: <span class="hljs-number">2000</span>
  },
  <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, cb</span>) </span>{
    cb(<span class="hljs-literal">null</span>, req.a + req.b)
  }
)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="async-await"></a><a href="#async-await" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Async / Await</h2>
<p>You can also pass an async function.</p>
<pre><code class="hljs css language-js">hemera.add({
  <span class="hljs-attr">topic</span>: <span class="hljs-string">"math"</span>,
  <span class="hljs-attr">cmd</span>: <span class="hljs-string">"add"</span>
}, <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> req.a + req.b
})

<span class="hljs-keyword">let</span> resp = <span class="hljs-keyword">await</span> hemera.act({
  <span class="hljs-attr">topic</span>: <span class="hljs-string">"math"</span>,
  <span class="hljs-attr">cmd</span>: <span class="hljs-string">"add"</span>
})

resp.data <span class="hljs-comment">// response data</span>
resp.context <span class="hljs-comment">// the parent context to retain meta and trace informations</span>

resp = <span class="hljs-keyword">await</span> resp.context.act(...)
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/hemera/docs/5.0.0-rc.2/installation.html"><span class="arrow-prev">← </span><span>Installation</span></a><a class="docs-next button" href="/hemera/docs/5.0.0-rc.2/pattern-matching.html"><span>Pattern matching</span><span class="arrow-next"> →</span></a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/hemera/" class="nav-home"><img src="/hemera/img/hemera-blackwhite.png" alt="Hemera" width="66" height="58"/></a><div><h5>Docs</h5><a href="/hemera/docs/installation.html">Getting Started</a><a href="/hemera/docs/plugin.html">Create a plugin</a><a href="/hemera/docs/api.html">API Reference</a></div><div><h5>Community</h5><a href="/hemera/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/hemera" target="_blank">Stack Overflow</a><a href="https://gitter.im/hemerajs/hemera">Gitter Chat</a><a href="https://twitter.com/hemerajs" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/hemera/blog">Blog</a><a href="https://github.com/hemerajs/hemera">GitHub</a><a class="github-button" href="https://github.com/hemerajs/hemera/" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2019 Hemera.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '5620e631e688fee9d15ed89f7d258f1a',
                indexName: 'hemerajs',
                inputSelector: '#search_input_react'
              });
            </script></body></html>